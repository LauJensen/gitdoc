<project name="GitDoc" default="jar">

	<description>
		Build with "ant jar".
	</description>

	<property name="src" location="src"/>
	<property name="build" location="classes"/>
	<property name="jarfile" location="gitdoc.jar"/>

	<property file="local.properties"/>

	<target name="init" depends="clean">
		<tstamp/>
		<mkdir dir="${build}"/>
	</target>

	<target name="aot" depends="init"
		description="Compile Clojure sources.">
		<java classname="clojure.lang.Compile">
			<classpath>
				<pathelement location="${build}"/>
				<pathelement location="${src}"/>
				<pathelement location="${gitdoc.jar}"/>
			</classpath>
			<sysproperty key="clojure.compile.path" value="${build}"/>
			<arg value="dk.bestinclass.gitdoc"/>
		</java>
	</target>

	<target name="jar" depends="aot"
		description="Create jar file.">
		<jar jarfile="${jarfile}">
			<fileset file="README.txt"/>
			<fileset file="LICENSE.txt"/>
			<fileset dir="${src}" includes="**/*.clj"/>
			<!-- Make sure, we don't include dependencies. -->
			<fileset dir="${build}" includes="dk/bestinclass/**/*.class"/>
			<manifest>
				<attribute name="Class-Path" value="."/>
			</manifest>
		</jar>
	</target>

	<target name="clean"
		description="Remove autogenerated files and directories.">
		<delete dir="${build}"/>
		<delete file="${jarfile}"/>
	</target>

</project>

<!-- vim: set ts=4 : -->
